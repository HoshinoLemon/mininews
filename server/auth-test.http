@baseUrl = http://localhost:8080
@password = Passw0rd!

### 1) Health
GET {{baseUrl}}/api/health

### 2) 注册普通用户：用户名在这里生成（每次唯一）
POST {{baseUrl}}/api/auth/register
Content-Type: application/json

{
  "username": "u{{$timestamp}}",
  "password": "{{password}}"
}
> {%
    if (response.body && response.body.data && response.body.data.username) {
        client.global.set("username", response.body.data.username);
    }
%}

### 3) 普通用户登录（使用上一步保存的 username），保存 tokenUser
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "username": "{{username}}",
  "password": "{{password}}"
}
> {%
    if (response.body && response.body.data && response.body.data.token) {
        client.global.set("tokenUser", response.body.data.token);
    }
%}

### 4) 未带 token 访问 admin（应 401）
GET {{baseUrl}}/api/admin/ping

### 5) admin 登录，保存 tokenAdmin（前提：你已执行 SQL 更新 admin 的 password_hash）
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "username": "admin",
  "password": "Admin@123456"
}
> {%
    if (response.body && response.body.data && response.body.data.token) {
        client.global.set("tokenAdmin", response.body.data.token);
    }
%}

### 6) 带普通用户 token 访问 admin（应 403）
GET {{baseUrl}}/api/admin/ping
Authorization: Bearer {{tokenUser}}

### 7) 带 admin token 访问 admin（应 200）
GET {{baseUrl}}/api/admin/ping
Authorization: Bearer {{tokenAdmin}}

### 8) 不带 token 发评论（应 401）
POST {{baseUrl}}/api/news/2/comments
Content-Type: application/json

{
  "body": "匿名评论（应该失败）"
}

### 9) 带普通用户 token 发评论（应 200）
POST {{baseUrl}}/api/news/2/comments
Authorization: Bearer {{tokenUser}}
Content-Type: application/json

{
  "body": "这是用户评论（应成功）"
}

### 10) 获取评论列表（GET 默认不要求登录）
GET {{baseUrl}}/api/news/2/comments
